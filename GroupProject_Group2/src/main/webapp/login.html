<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Login</title>
		<link rel="stylesheet" type="text/css" media="screen, projection"
		href="http://www.blueprintcss.org/blueprint/screen.css" />
		<link rel="stylesheet" type="text/css" media="screen, projection"
		href="http://www.blueprintcss.org/blueprint/plugins/buttons/screen.css" />
		<link rel="stylesheet" type="text/css" media="print"
		href="http://www.blueprintcss.org/blueprint/print.css" />
		<!--[if IE]><link rel="stylesheet" type="text/css" media="screen, projection"
		href="http://www.blueprintcss.org/blueprint/ie.css"><![endif]-->
		<script type="text/javascript"
		src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
		<script type="text/javascript" src="login.js"></script>
		<style type="text/css">
			#loginContent {
				width: 350px;
				margin: 100px auto;
			}

			button[type] {
				margin: 0.5em 0;
			}
		</style>
	</head>
	<body>

		<div id="response">
			<pre></pre>
		</div>

		<div id="loginContent" class="container">
			<div id="loginResult" style="display: none;"></div>
			<form id="loginForm" name="loginForm">
				<!--   method="post"-->
				<!--  action="http://localhost:8080/cf/rest/users" >   -->
				<fieldset>
					<legend>
						Enter information
					</legend>
					<p>
						<label for="username">Username</label>
						<br />
						<input type="text"
						id="username" name="username" class="text" size="20" />
					</p>
					<p>
						<label for="password">Password</label>
						<br />
						<input
						type="password" id="password" name="password" class="text"
						size="20" />
					</p>
					<p>
						<button type="submit" class="button positive">
							<img alt="ok"
							src="http://www.blueprintcss.org/blueprint/plugins/buttons/icons/tick.png" />
							Login
						</button>
					</p>
				</fieldset>
			</form>

			<script
			src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
			<script>
				(function($) {
					function processForm(e) {
						$.ajax({
							url : 'http://localhost:8080/GroupProject_Group2/rest/users/getuser',
							dataType : 'json',
							type : 'post',
							contentType : 'application/json',
							data : JSON.stringify({
								"username" : $('#username').val(),
								"password" : $('#password').val()
							}),
							processData : false,
							success : function(data, textStatus, jQxhr) {
								if (data != null) {
									$('#response pre').html(JSON.stringify(data));
									createCookie('usercookie', JSON.stringify(data), 0);
									var key = 'userType';
								//alert("userType:  " + data[key]);

								
									if (data[key]==0) {
										window.location.replace("/GroupProject_Group2/Welcome.html");
									} 
									else if(data[key]==1) {
										window.location.replace("/GroupProject_Group2/net_manager_index.html");
									}
									else if(data[key]==2) {
										window.location.replace("/GroupProject_Group2/support_eng_index.html");
									}
									else if(data[key]==3) {
										window.location.replace("/GroupProject_Group2/index.html");
									}
									else {
										window.location.replace('<p>Error</p><a href ="/GroupProject_Group2/">Continue</a>');
									}
									

								}
							},
							error : function(jqXhr, textStatus, errorThrown) {
								document.write('<p>Error</p><a href ="login.html">Continue</a>');
								console.log(errorThrown);

							}
						});
						e.preventDefault();
					}


					$('#loginForm').submit(processForm);
				})(jQuery);

				function createCookie(name, value, days) {
					if (days) {
						var date = new Date();
						date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
						var expires = "; expires=" + date.toGMTString();
					} else
						var expires = "";
					document.cookie = name + "=" + value + expires + "; path=/";
				}

				function eraseCookie(name) {
					createCookie(name, "", -1);
				}

			</script>

		</div>
	</body>
</html>
